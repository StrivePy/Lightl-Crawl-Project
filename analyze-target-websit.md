# 分析目标网站

打开今日头条：[https://www.toutiao.com/](https://www.toutiao.com/)  
右边搜索窗口输入：**街拍**  
进入索引页面：[https://www.toutiao.com/search/?keyword=街拍](https://www.toutiao.com/search/?keyword=街拍)  
索引页展示的图片有图集形式和非图集形式，本次目标就是获取以图集形式展示的图片相关信息。查看索引页源码，在原始html文件（document）并没有寻找到任何关于图片的信息，接下来看图片是否是通过Ajax请求来加载的，点击**XHR**标签来查看Ajax请求，发现有一个名为：

```py
?offset=0&format=json&keyword=%E8%A1%97%E6%8B%8D&autoload=true&count=20&cur_tab=1&from=search_tab
```

的请求，返回的是Json数据，预览一下，在**data**中发现了索引页的图片相关信息，每一条data属性中的_**article\_url**_是每一组图的链接和标题。该_**article\_url**_可能打开的是图集，也有可能打开的不是图集。到时候筛选一下。  
在索引页打开一个图集，分析该网页的源码，在原始的html（document）中没有发现图片的相关信息，再看一下图片是否是通过Ajax请求加载的，在Ajax请求结果中只发现了评论和底部组图的相关信息，并没有图集图片的相关内容。再返回原始的html仔细查看，发现了一个：

```py
gallery: JSON.parse("{\"count\":7,\"sub_images\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213a0000d62a02db7e89\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213a0000d62a02db7e89\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/213a0000d62a02db7e89\"},{\"url\":\"http:\\/\\/pb1.pstatp.com\\/origin\\/213a0000d62a02db7e89\"}],\"uri\":\"origin\\/213a0000d62a02db7e89\",\"height\":1035},{\"url\":\"http:\\/\\/p1.pstatp.com\\/origin\\/21320003dbf1358efda0\",\"width\":1024,\"url_list\":[{\"url\":\"http:\\/\\/p1.pstatp.com\\/origin\\/21320003dbf1358efda0\"},{\"url\":\"http:\\/\\/pb3.pstatp.com\\/origin\\/21320003dbf1358efda0\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/21320003dbf1358efda0\"}],\"uri\":\"origin\\/21320003dbf1358efda0\",\"height\":1536},{\"url\":\"http:\\/\\/p1.pstatp.com\\/origin\\/212c0003abdc917720b7\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p1.pstatp.com\\/origin\\/212c0003abdc917720b7\"},{\"url\":\"http:\\/\\/pb3.pstatp.com\\/origin\\/212c0003abdc917720b7\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/212c0003abdc917720b7\"}],\"uri\":\"origin\\/212c0003abdc917720b7\",\"height\":1035},{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/21380000dd25dcb6e362\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/21380000dd25dcb6e362\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/21380000dd25dcb6e362\"},{\"url\":\"http:\\/\\/pb1.pstatp.com\\/origin\\/21380000dd25dcb6e362\"}],\"uri\":\"origin\\/21380000dd25dcb6e362\",\"height\":1035},{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213b0003c770b49f08ac\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213b0003c770b49f08ac\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/213b0003c770b49f08ac\"},{\"url\":\"http:\\/\\/pb1.pstatp.com\\/origin\\/213b0003c770b49f08ac\"}],\"uri\":\"origin\\/213b0003c770b49f08ac\",\"height\":1035},{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213a0000d62b9b7edcd1\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/213a0000d62b9b7edcd1\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/213a0000d62b9b7edcd1\"},{\"url\":\"http:\\/\\/pb1.pstatp.com\\/origin\\/213a0000d62b9b7edcd1\"}],\"uri\":\"origin\\/213a0000d62b9b7edcd1\",\"height\":1035},{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/21380000dd39ab9621db\",\"width\":690,\"url_list\":[{\"url\":\"http:\\/\\/p3.pstatp.com\\/origin\\/21380000dd39ab9621db\"},{\"url\":\"http:\\/\\/pb9.pstatp.com\\/origin\\/21380000dd39ab9621db\"},{\"url\":\"http:\\/\\/pb1.pstatp.com\\/origin\\/21380000dd39ab9621db\"}],\"uri\":\"origin\\/21380000dd39ab9621db\",\"height\":1035}],\"max_img_width\":1024,\"labels\":[\"\\u7f8e\\u5973\",\"\\u65f6\\u88c5\\u642d\\u914d\"],\"sub_abstracts\":[\"\\u5bbd\\u677eT\\u6064\\u886b\\u642d\\u914d\\u7ea2\\u8272\\u77ed\\u88e4\\uff0c\\u975e\\u5e38\\u6709\\u89c6\\u89c9\\u6548\\u679c\\u7684\\u989c\\u8272\\u642d\\u914d\\uff0c\\u70b9\\u4e2a\\u8d5e\",\"\\u957f\\u6b3e\\u80cc\\u5fc3\\uff0c\\u642d\\u914d\\u77ed\\u88e4\\u7684\\u7a7f\\u6cd5\\u6bd4\\u8f83\\u6027\\u611f\\u3001\\u53ef\\u7231\",\"\\u897f\\u88c5\\u5143\\u7d20\\u7684\\u5957\\u88c5\\uff0c\\u677f\\u578b\\u5f88\\u6b63\\u52a0\\u4e0a\\u77ed\\u88e4\\u5f88\\u9002\\u5408\\u590f\\u5b63\\u98ce\\u7684\\u6b63\\u88c5\\u9009\\u62e9\",\"\\u886c\\u886b\\u77ed\\u88d9\\u98ce\\uff0c\\u590f\\u5b63\\u6e05\\u723d\\u642d\\u914d\\u7684\\u9996\\u9009\",\"\\u7b80\\u5355\\u9ed1\\u8272\\u8fde\\u8863\\u88d9\\uff0c\\u900f\\u89c6\\u7684\\u5143\\u7d20\\u52a0\\u4e0a\\u77ed\\u88e4\\u7684\\u7a7f\\u6cd5\\u4ece\\u5f88\\u65e9\\u5c31\\u6709\\u4e86\",\"\\u4e2a\\u6027\\u7834\\u6d1e\\u886b\\u642d\\u914d\\u725b\\u4ed4\\u77ed\\u88e4\\uff0c\\u4e2a\\u6027\\u7684\\u6d1e\\u6d1e\\u8863\\u56de\\u5934\\u7387\\u80af\\u5b9a\\u4e0d\\u4f4e\",\"\\u4e2a\\u6027\\u62fc\\u63a5\\u5f00\\u9886\\u886b\\uff0c\\u642d\\u914d\\u9ed1\\u8272\\u957f\\u88e4\\uff0c\\u7c89\\u8272\\u548c\\u9ed1\\u8272\\u7684\\u642d\\u914d\\u98ce\\u683c\\u8fd8\\u7b97\\u53ef\\u4ee5\"],\"sub_titles\":[\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\",\"\\u8def\\u4eba\\u8857\\u62cd\\uff0c\\u91cd\\u5e86\\u8857\\u62cd\\u9ad8\\u5206\\u8def\\u4eba\\u7f8e\\u5973\"]}")
```
的Json数据解析，通过比较url发现，此内容真是要提取的图片内容，只不过是以Json格式存放的，所以只要拿到这个数据再解析一下，就能获得图集中每张图片的url。拿到图片的url就能进行接下来的数据下载和存放工作。



